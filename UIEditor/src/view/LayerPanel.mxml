<?xml version="1.0" encoding="utf-8"?>
<s:Panel xmlns:fx="http://ns.adobe.com/mxml/2009"
		 xmlns:s="library://ns.adobe.com/flex/spark"
		 xmlns:mx="library://ns.adobe.com/flex/mx"
		 width="400" height="300" addedToStage="addToStageHandler(event)" color="#000000">
	<s:layout>
		<s:VerticalLayout/>
	</s:layout>
	<fx:Script>
		<![CDATA[
			import event.UIEvent;
			
			import mx.collections.ArrayCollection;
			import mx.collections.ArrayList;
			import mx.collections.IList;
			import mx.collections.XMLListCollection;
			
			import spark.events.IndexChangeEvent;
			import spark.modules.Module;
			
			private var _container:DisplayObjectContainer;
			
			protected function addToStageHandler(event:Event):void
			{
				App.layerManager.layerPanel = this;
				initEvent();
			}
			
			private function initEvent():void
			{
				App.addEventListener(UIEvent.STAGE_SELECT_UPDATE,selectsUpdateHandler);
			}
			
			public function setChild(container:DisplayObjectContainer):void
			{
				_container = container;
				updateList();
			}
			
			private function updateList():void
			{
				var count:int;
				var seletcedArr:Array = [];
				var dp:ArrayCollection = new ArrayCollection();
				for (var i:int = 0; i < _container.numChildren; i++) 
				{
					var item:HotRectControl = _container.getChildAt(i) as HotRectControl;
					if(item)
					{
						dp.addItem({"label":item.name,"type":1,"info":item.uiInfo});
						if(item.selected)seletcedArr.push(count);
						count ++;
					}
				}
				itemList.dataProvider = dp;
				itemList.selectedIndices = seletcedArr;
			}
			
			protected function upClickHandler(event:MouseEvent):void
			{
							
			}
			
			protected function downClickHandler(event:MouseEvent):void
			{
				
			}
			
			protected function delClickHandler(event:MouseEvent):void
			{
				
			}
			
			private function selectionChangingHandler():void 
			{
				trace(itemList.selectedItems);	
				trace(itemList.selectedIndices);
				App.dispathEvent(new UIEvent(UIEvent.LAYERS_SELECT_UPDATE,itemList.selectedIndices));
			}
			
			private function selectsUpdateHandler(evt:UIEvent):void
			{
				var arr:Array = evt.data as Array;
				itemList.selectedIndices = arr;
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<!-- 将非可视元素（例如服务、值对象）放在此处 -->
	</fx:Declarations>
	<s:Group id="layersGroup" width="100%" height="90%">
		<mx:List id="itemList" width="100%" height="100%" color="#000000" contentBackgroundColor="#FFFFFF"
			 allowMultipleSelection="true"
			iconField="icon" labelField="label"
			click="selectionChangingHandler();"
			>
		</mx:List>
	</s:Group>
	<s:Group width="100%" height="20%">
		<s:layout>
			<s:HorizontalLayout/>
		</s:layout>
		<s:Image x="10" y="241" source="@Embed('assets/systemIcons/begin.gif')" click="upClickHandler(event)" toolTip="上移（Ctrl + 上）"/>
		<s:Image x="31" y="241" source="@Embed('assets/systemIcons/right.gif')" click="downClickHandler(event)" toolTip="上移（Ctrl + 下）"/>
		<s:Image x="53" y="241" source="@Embed('assets/systemIcons/rungc_co.gif')" click="delClickHandler(event)" toolTip="删除（DELETE）"/>
	</s:Group>
</s:Panel>
